// Generated by purs version 0.15.10
import * as Control_Alt from "../Control.Alt/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Apply from "../Control.Apply/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Function from "../Data.Function/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Generic_Rep from "../Data.Generic.Rep/index.js";
import * as Data_Identity from "../Data.Identity/index.js";
import * as Data_Lens_Internal_Wander from "../Data.Lens.Internal.Wander/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Ordering from "../Data.Ordering/index.js";
import * as Data_Show_Generic from "../Data.Show.Generic/index.js";
import * as Parsing from "../Parsing/index.js";
import * as URI_Authority from "../URI.Authority/index.js";
import * as URI_Common from "../URI.Common/index.js";
import * as URI_Path from "../URI.Path/index.js";
import * as URI_Path_Absolute from "../URI.Path.Absolute/index.js";
import * as URI_Path_NoScheme from "../URI.Path.NoScheme/index.js";
var apply = /* #__PURE__ */ Control_Apply.apply(Parsing.applyParserT);
var map = /* #__PURE__ */ Data_Functor.map(Parsing.functorParserT);
var wrapParser = /* #__PURE__ */ URI_Common.wrapParser(Data_Identity.monadIdentity);
var alt = /* #__PURE__ */ Control_Alt.alt(Parsing.altParserT);
var pure = /* #__PURE__ */ Control_Applicative.pure(Parsing.applicativeParserT);
var RelativePartAuthIsSymbol = {
    reflectSymbol: function () {
        return "RelativePartAuth";
    }
};
var RelativePartNoAuthIsSymbol = {
    reflectSymbol: function () {
        return "RelativePartNoAuth";
    }
};
var RelativePartAuth = /* #__PURE__ */ (function () {
    function RelativePartAuth(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    RelativePartAuth.create = function (value0) {
        return function (value1) {
            return new RelativePartAuth(value0, value1);
        };
    };
    return RelativePartAuth;
})();
var RelativePartNoAuth = /* #__PURE__ */ (function () {
    function RelativePartNoAuth(value0) {
        this.value0 = value0;
    };
    RelativePartNoAuth.create = function (value0) {
        return new RelativePartNoAuth(value0);
    };
    return RelativePartNoAuth;
})();
var print = function (opts) {
    return function (v) {
        if (v instanceof RelativePartAuth) {
            return URI_Authority.print(opts)(v.value0) + URI_Path.print(opts.printPath(v.value1));
        };
        if (v instanceof RelativePartNoAuth) {
            return Data_Maybe.maybe("")((function () {
                var $145 = Data_Either.either(URI_Path_Absolute.print)(URI_Path_NoScheme.print);
                return function ($146) {
                    return $145(opts.printRelPath($146));
                };
            })())(v.value0);
        };
        throw new Error("Failed pattern match at URI.RelativePart (line 120, column 14 - line 124, column 79): " + [ v.constructor.name ]);
    };
};
var parser = function (opts) {
    var withAuth = apply(map(RelativePartAuth.create)(URI_Authority.parser(opts)))(wrapParser(opts.parsePath)(URI_Path.parser));
    var noAuthPath = alt(map(Data_Maybe.Just.create)(wrapParser(function ($147) {
        return opts.parseRelPath(Data_Either.Left.create($147));
    })(URI_Path_Absolute.parse)))(alt(map(Data_Maybe.Just.create)(wrapParser(function ($148) {
        return opts.parseRelPath(Data_Either.Right.create($148));
    })(URI_Path_NoScheme.parse)))(pure(Data_Maybe.Nothing.value)));
    var withoutAuth = map(RelativePartNoAuth.create)(noAuthPath);
    return alt(withAuth)(withoutAuth);
};
var genericRelativePart = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return new RelativePartAuth(x.value0.value0, x.value0.value1);
        };
        if (x instanceof Data_Generic_Rep.Inr) {
            return new RelativePartNoAuth(x.value0);
        };
        throw new Error("Failed pattern match at URI.RelativePart (line 50, column 1 - line 50, column 92): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof RelativePartAuth) {
            return new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, x.value1));
        };
        if (x instanceof RelativePartNoAuth) {
            return new Data_Generic_Rep.Inr(x.value0);
        };
        throw new Error("Failed pattern match at URI.RelativePart (line 50, column 1 - line 50, column 92): " + [ x.constructor.name ]);
    }
};
var genericShow = /* #__PURE__ */ Data_Show_Generic.genericShow(genericRelativePart);
var showRelativePart = function (dictShow) {
    var showAuthority = URI_Authority.showAuthority(dictShow);
    return function (dictShow1) {
        var genericShowArgsProduct = Data_Show_Generic.genericShowArgsProduct(Data_Show_Generic.genericShowArgsArgument(showAuthority(dictShow1)));
        return function (dictShow2) {
            var genericShowSum = Data_Show_Generic.genericShowSum(Data_Show_Generic.genericShowConstructor(genericShowArgsProduct(Data_Show_Generic.genericShowArgsArgument(dictShow2)))(RelativePartAuthIsSymbol));
            return function (dictShow3) {
                return {
                    show: genericShow(genericShowSum(Data_Show_Generic.genericShowConstructor(Data_Show_Generic.genericShowArgsArgument(Data_Maybe.showMaybe(dictShow3)))(RelativePartNoAuthIsSymbol)))
                };
            };
        };
    };
};
var eqRelativePart = function (dictEq) {
    var eqAuthority = URI_Authority.eqAuthority(dictEq);
    return function (dictEq1) {
        var eq = Data_Eq.eq(eqAuthority(dictEq1));
        return function (dictEq2) {
            var eq1 = Data_Eq.eq(dictEq2);
            return function (dictEq3) {
                var eq2 = Data_Eq.eq(Data_Maybe.eqMaybe(dictEq3));
                return {
                    eq: function (x) {
                        return function (y) {
                            if (x instanceof RelativePartAuth && y instanceof RelativePartAuth) {
                                return eq(x.value0)(y.value0) && eq1(x.value1)(y.value1);
                            };
                            if (x instanceof RelativePartNoAuth && y instanceof RelativePartNoAuth) {
                                return eq2(x.value0)(y.value0);
                            };
                            return false;
                        };
                    }
                };
            };
        };
    };
};
var ordRelativePart = function (dictOrd) {
    var ordAuthority = URI_Authority.ordAuthority(dictOrd);
    var eqRelativePart1 = eqRelativePart(dictOrd.Eq0());
    return function (dictOrd1) {
        var compare = Data_Ord.compare(ordAuthority(dictOrd1));
        var eqRelativePart2 = eqRelativePart1(dictOrd1.Eq0());
        return function (dictOrd2) {
            var compare1 = Data_Ord.compare(dictOrd2);
            var eqRelativePart3 = eqRelativePart2(dictOrd2.Eq0());
            return function (dictOrd3) {
                var compare2 = Data_Ord.compare(Data_Maybe.ordMaybe(dictOrd3));
                var eqRelativePart4 = eqRelativePart3(dictOrd3.Eq0());
                return {
                    compare: function (x) {
                        return function (y) {
                            if (x instanceof RelativePartAuth && y instanceof RelativePartAuth) {
                                var v = compare(x.value0)(y.value0);
                                if (v instanceof Data_Ordering.LT) {
                                    return Data_Ordering.LT.value;
                                };
                                if (v instanceof Data_Ordering.GT) {
                                    return Data_Ordering.GT.value;
                                };
                                return compare1(x.value1)(y.value1);
                            };
                            if (x instanceof RelativePartAuth) {
                                return Data_Ordering.LT.value;
                            };
                            if (y instanceof RelativePartAuth) {
                                return Data_Ordering.GT.value;
                            };
                            if (x instanceof RelativePartNoAuth && y instanceof RelativePartNoAuth) {
                                return compare2(x.value0)(y.value0);
                            };
                            throw new Error("Failed pattern match at URI.RelativePart (line 0, column 0 - line 0, column 0): " + [ x.constructor.name, y.constructor.name ]);
                        };
                    },
                    Eq0: function () {
                        return eqRelativePart4;
                    }
                };
            };
        };
    };
};
var _relPath = function (dictWander) {
    return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
        var map1 = Data_Functor.map((dictApplicative.Apply0()).Functor0());
        var pure1 = Control_Applicative.pure(dictApplicative);
        return function (f) {
            return function (a) {
                if (a instanceof RelativePartNoAuth) {
                    return map1(RelativePartNoAuth.create)(f(a.value0));
                };
                return pure1(a);
            };
        };
    });
};
var _path = function (dictWander) {
    return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
        var map1 = Data_Functor.map((dictApplicative.Apply0()).Functor0());
        var pure1 = Control_Applicative.pure(dictApplicative);
        return function (f) {
            return function (v) {
                if (v instanceof RelativePartAuth) {
                    return map1(RelativePartAuth.create(v.value0))(f(v.value1));
                };
                return pure1(v);
            };
        };
    });
};
var _authority = function (dictWander) {
    return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
        var map1 = Data_Functor.map((dictApplicative.Apply0()).Functor0());
        var pure1 = Control_Applicative.pure(dictApplicative);
        return function (f) {
            return function (v) {
                if (v instanceof RelativePartAuth) {
                    return map1(Data_Function.flip(RelativePartAuth.create)(v.value1))(f(v.value0));
                };
                return pure1(v);
            };
        };
    });
};
export {
    RelativePartAuth,
    RelativePartNoAuth,
    parser,
    print,
    _authority,
    _path,
    _relPath,
    eqRelativePart,
    ordRelativePart,
    genericRelativePart,
    showRelativePart
};
export {
    Authority,
    IPv4Address,
    IPv6Address,
    NameAddress,
    _IPv4Address,
    _IPv6Address,
    _NameAddress,
    _hosts,
    _userInfo
} from "../URI.Authority/index.js";
